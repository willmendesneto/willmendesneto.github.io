{"componentChunkName":"component---src-templates-post-js","path":"/posts/leveling-up-react-hooks-with-typescript-a-wizards-journey/","result":{"data":{"markdownRemark":{"html":"<h3>Introduction</h3>\n<p>I want to share a real-world example of how embracing TypeScript can significantly improve your React hooks and overall codebase. We'll be diving into the evolution of <a href=\"https://github.com/willmendesneto/react-sweet-wizard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react-sweet-wizard</a>, a package I built to simplify form wizards - eventually called as Form Stepper or Form steps - in React. Think of it as a guided tour through the land of forms, but with less frustration and more type safety!</p>\n<blockquote>\n<p>For more details about React Sweet Wizard, why it was created, benefits, usage and more, please check the post <a href=\"https://willmendesneto.com/posts/introducing-react-sweet-wizard-simplifying-the-form-flow-of-your-react-app\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Introducing React Sweet Wizard: Simplifying the Form Flow of Your React App</a></p>\n</blockquote>\n<p>If you've ever wrestled with complex forms or multi-step processes in React, you know the struggle. Managing state and navigation can quickly become a tangled mess. That's where <a href=\"https://github.com/willmendesneto/react-sweet-wizard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react-sweet-wizard</a> comes in. But as the project  and evolved, so did the need for better type safety and code maintainability.</p>\n<p>Let's take a close look at the \"before\" and \"after\" scenarios in this repository, and walk through the ü™Ñ TypeScript magic ü™Ñ that made a world of difference.</p>\n<h3>Initial Scenario and Type-Challenges implementing Wizard</h3>\n<p>Here's a snippet of the original implementation:</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Defining initial state</span>\n<span class=\"token comment\">// ‚ùå `steps` prop is not even typed</span>\n<span class=\"token keyword\">const</span> initialState<span class=\"token operator\">:</span> WizardStepperReducerState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//...</span>\n<span class=\"token comment\">// Original Context Creation</span>\n<span class=\"token comment\">// ‚ùå Forcing empty object to avoid runtime, even though </span>\n<span class=\"token comment\">// the code should use nullable pattern to cover that</span>\n<span class=\"token keyword\">const</span> WizardStepperContext <span class=\"token operator\">=</span> <span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//...</span>\n<span class=\"token comment\">// Original useWizardContext</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> useWizardContext <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> _P <span class=\"token operator\">=</span> <span class=\"token builtin\">never</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>WizardStepperContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ‚ùå Runtime error if `context` value returns as `null` - which is a real scenario in some apps, but not here</span>\n  <span class=\"token comment\">// ‚ùå Instead of check if `context !== null` or `!context` </span>\n  <span class=\"token comment\">// it uses `Object.keys(context).length === 0` which uses way more resources</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Please make sure you're wrapping all the steps in a 'WizardProvider' component</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ‚ùå forcing type using `as`</span>\n  <span class=\"token keyword\">return</span> context <span class=\"token keyword\">as</span> WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">const</span> goTo <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>   \n  <span class=\"token comment\">// ‚ùå At this stage, `stepId` was not even typed üò±</span>\n  stepId <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'GOTO_PAGE'</span><span class=\"token punctuation\">,</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> stepId <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>dispatch<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>At first glance, it works. But dig a little deeper, and you'll find some type-related gremlins lurking.</p>\n<ul>\n<li><strong>Generic Context without Specific Types</strong>: The WizardStepperContext was created without specific type parameters, leading to potential any pitfalls.</li>\n<li><strong>Loose Type Definitions</strong>: The WizardStepperReducerState and Action types lacked precision, making it harder to catch errors early.</li>\n<li><strong>Assumptions and Type Casting</strong>: The useWizardContext hook relied on type casting, which can hide underlying type issues.</li>\n</ul>\n<h3>Type-Safe Wizard: improving Developer Experience and ergonomics</h3>\n<p>Now, let's fast-forward to the improved version:</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ‚úÖ Context now is using nullable pattern</span>\n<span class=\"token keyword\">const</span> WizardStepperContext <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">createContext</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Improved useWizardContext</span>\n<span class=\"token comment\">// ‚úÖ Now the code is using generics and returning a `Readonly` context</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> useWizardContext <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span></span> <span class=\"token attr-name\">extends</span> <span class=\"token attr-name\">DefaultWizardStepProps</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">(): Readonly&lt;WizardStepperContextProps&lt;T>> => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context<span class=\"token operator\">:</span> Readonly<span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>WizardStepperContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ‚úÖ Type guard in action üéâ</span>\n  <span class=\"token comment\">// ‚úÖ Perf++ by checking `!context` instead of `Object.keys()`</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Please make sure you're wrapping all the steps in a 'WizardProvider' component</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">;\n\n// Generic type used in State and Actions\ninterface WizardStepperReducerState&lt;T> </span><span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\ntype Action&lt;T> =\n  | </span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'NEXT_PAGE'</span> <span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  | </span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'PREV_PAGE'</span> <span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  | </span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'GOTO_PAGE'</span><span class=\"token punctuation\">;</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> stepId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  | </span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'SET_STEP_COUNT'</span><span class=\"token punctuation\">;</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token plain-text\">;\n\n// Improved goTo\nconst goTo = useCallback(\n  // ‚úÖ typed `stepId`\n  (stepId: number | string) => </span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'GOTO_PAGE'</span><span class=\"token punctuation\">,</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> stepId <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n  [dispatch]\n);</span></code></pre></div>\n<p>Ok, so... what changed really? A lot, actually! Here are the key improvements and their benefits:</p>\n<h4>Generic State and Actions</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ‚úÖ `steps` is now typed üéâ</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">WizardStepperReducerState<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Action<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'SET_STEP_COUNT'</span><span class=\"token punctuation\">;</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Apply these code changes also improved type safety, reduced runtime errors, and better code predictability. Generics can be heavily used in this scenario, leading to consumers the responsibility to define specific types. Since this will be done on their end already to map this data, is even better to enforce this validation between project and package.</p>\n<h4>Typed Context</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ‚úÖ Applying generics and also using nullable pattern </span>\n<span class=\"token keyword\">const</span> WizardStepperContext <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">createContext</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Enhanced type checking, preventing accidental misuse of context values. Also, by using nullable pattern the code won't be checking for <code class=\"language-text\">Object.keys()</code> which is way costly than a simple <code class=\"language-text\">!context</code> runtime check.</p>\n<h4>Readonly Context</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> useWizardContext <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span></span> <span class=\"token attr-name\">extends</span> <span class=\"token attr-name\">DefaultWizardStepProps</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">(): Readonly&lt;WizardStepperContextProps&lt;T>> => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context<span class=\"token operator\">:</span> Readonly<span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>WizardStepperContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Type guard in action üéâ</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Please make sure you're wrapping all the steps in a 'WizardProvider' component</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">;</span></code></pre></div>\n<p><code class=\"language-text\">Readonly</code> is a builtin typescript type and prevents accidental modification of the context value, ensuring data integrity. In this case, it can also avoid misusage on the consumer's side.</p>\n<h4>Improved <code class=\"language-text\">goTo</code> function</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">\n<span class=\"token keyword\">const</span> goTo <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">(</span>stepId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'GOTO_PAGE'</span><span class=\"token punctuation\">,</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> stepId <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>dispatch<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Increased flexibility and robustness, allowing steps to be identified by either <code class=\"language-text\">index</code> or <code class=\"language-text\">ID</code>, which can be a <code class=\"language-text\">number</code> or even a <code class=\"language-text\">string</code>.</p>\n<h4>Initial State Generic</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ‚úÖ Initial state now has `steps` as a generic type, which a game changer</span>\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>\n  <span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">DefaultWizardStepProps</span>\n<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> WizardStepperReducerState<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Improved type safety and reduced boilerplate. This is also taking advantage of direct generics usage in this codebase.</p>\n<h4>Explicit Inline Props Typing</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Step</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id<span class=\"token punctuation\">,</span> children <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> children<span class=\"token operator\">:</span> ReactNode <span class=\"token operator\">|</span> <span class=\"token constant\">JSX</span><span class=\"token punctuation\">.</span>Element <span class=\"token operator\">|</span> <span class=\"token constant\">JSX</span><span class=\"token punctuation\">.</span>Element<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This one is necessary for bundle size reasons, something to always be concerned when implementing packages, dependencies, etc. By applying this approach for such small component, the bundle is also decreased.</p>\n<blockquote>\n<p>‚ö†Ô∏è Good to mention this should NOT be applied in all scenarios due to maintenability implications. So keep that in mind if you find a scenario you can implement this technique. ‚ö†Ô∏è</p>\n</blockquote>\n<hr />\n<h3>Benefits for Consumers and the Codebase</h3>\n<p>These TypeScript improvements aren't just show off. They directly benefit consumers of the react-sweet-wizard package and improve the codebase in several ways:</p>\n<ul>\n<li><strong>Enhanced Reliability</strong>: Type safety catches errors early, reducing the likelihood of runtime issues.</li>\n<li><strong>Improved Maintainability</strong>: Clearer type definitions make the code easier to understand and modify.</li>\n<li><strong>Better Developer Experience</strong>: Type hints and autocompletion in IDEs make development smoother and faster.</li>\n<li><strong>Increased Code Confidence</strong>: Knowing that the code is type-safe boosts confidence during development and deployment.</li>\n</ul>\n<hr />\n<h3>Tips and Tricks: Applying TypeScript Best Practices to React Hooks</h3>\n<p>Let's distill the lessons learned during react-sweet-wizard refactoring into actionable tips you can apply to your own React hooks:</p>\n<h4>Embrace Generics for Reusable Hooks</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span></span> <span class=\"token attr-name\">extends</span> <span class=\"token attr-name\">DefaultWizardStepProps</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">(): WizardStepperReducerState&lt;T> => (</span><span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">);</span></code></pre></div>\n<p>By making <code class=\"language-text\">initialState()</code> generic, the code is also allowing it to work with various step types (T). This eliminates the need for type casting and ensures that the state is always initialized with the correct type. Apply this pattern to any hook that needs to handle different data structures.</p>\n<h4>Leverage Readonly for Context Integrity</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> useWizardContext <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span></span> <span class=\"token attr-name\">extends</span> <span class=\"token attr-name\">DefaultWizardStepProps</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">(): Readonly&lt;WizardStepperContextProps&lt;T>> => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context<span class=\"token operator\">:</span> Readonly<span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>WizardStepperContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Type guard in action üéâ</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Please make sure you're wrapping all the steps in a 'WizardProvider' component</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">;</span></code></pre></div>\n<p>Returning <code class=\"language-text\">Readonly&lt;WizardStepperContextProps&lt;T>></code> from <code class=\"language-text\">useWizardContext()</code> prevents consumers from accidentally modifying context values. This is crucial for maintaining state integrity and preventing unexpected side effects.</p>\n<h4>Explicit types for Action and State</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Action<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'NEXT_PAGE'</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'PREV_PAGE'</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'GOTO_PAGE'</span><span class=\"token punctuation\">;</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> stepId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'SET_STEP_COUNT'</span><span class=\"token punctuation\">;</span> payload<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">WizardStepperReducerState<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n  activeStepIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  steps<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Defining explicit types for actions and state in the reducer makes the data flow more predictable. It helps catch type-related errors during development and improves code readability. Always type your reducer's state and actions as precisely as possible.</p>\n<h4>Type guard and avoiding runtime errors</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">  <span class=\"token keyword\">const</span> context<span class=\"token operator\">:</span> Readonly<span class=\"token operator\">&lt;</span>WizardStepperContextProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>WizardStepperContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Type guard in action üéâ</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Please make sure you're wrapping all the steps in a 'WizardProvider' component</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Since the value can be <code class=\"language-text\">null</code>, having a type guard is a mandatory approach to make sure the app will keep running as expected. In this case, the approach defined was to make sure developers/consumers will be aware of the misusage of the package rightaway, throwing a runtime error.</p>\n<h4>Test Your Types in Your CI Pipeline</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">tsc <span class=\"token parameter variable\">--noEmit</span></code></pre></div>\n<p>Running <code class=\"language-text\">tsc --noEmit</code> in your CI pipeline ensures that your TypeScript code is free of type errors. This is a crucial step in preventing type-related bugs from reaching production. Integrate this command into your build process to catch errors early.</p>\n<h3>That‚Äôs all for¬†now</h3>\n<p>TypeScript is a powerful tool for improving the reliability and maintainability of your React code. By embracing its features, you can create more robust and scalable applications.</p>\n<p>In the case of react-sweet-wizard, TypeScript has been a game-changer. It's made the codebase more predictable, easier to maintain, and safer to use.</p>\n<p>I hope you enjoyed this reading as much as I enjoyed writing it. Thank you so much for reading until the end and see you soon!</p>\n<hr />\n<h3>Cya üëã</h3>","frontmatter":{"date":"April 02, 2025","path":"/posts/leveling-up-react-hooks-with-typescript-a-wizards-journey","title":"Leveling Up React Hooks with TypeScript: A Wizard's Journey","tags":["frontend","test","open-source","vite","vitest","tooling","performance","architecture"],"status":"active"},"timeToRead":7}},"pageContext":{"postPath":"/posts/leveling-up-react-hooks-with-typescript-a-wizards-journey"}},"staticQueryHashes":["1271460761","63159454"],"slicesMap":{}}