{"componentChunkName":"component---src-templates-post-js","path":"/posts/why-track-loop-is-important-in-your-angular-apps","result":{"data":{"markdownRemark":{"html":"<h3>Introduction</h3>\n<p>Hello everyone. This post will be something good and easy to read, but totally essential if you care about performance in you Angular App. The idea of this post is talk about why your loop should gave track by with some index information.</p>\n<blockquote>\n<p>But we already know about it because angular documentation already talk about that</p>\n</blockquote>\n<p>I’m working as a consultant in biggest and medium angular projects and the problems around the teams forget about that approach creates a lot of problems. So what I’m writing here is basically an overview about the angular behaviours and why you need to take care about it.</p>\n<p>So…let’s go!</p>\n<h3>About Angular apps and loops</h3>\n<p>Since angular borns the idea was (and still is): make the WebApps development easier. And the framework provide us lots of tools to make our life simple as possible and delivery business value fast.</p>\n<p>Yeah! <em>delivery business value</em>! If your code doesn’t delivery business value, so we have something wrong…but I will talk more about that in the next posts.</p>\n<p>We have the concept of directives: a new way to handle with WebApps creating decoupled components with specific rules based in your application domain. All built in core directives use ng* pattern and that’s the case of our ngRepeat.</p>\n<p>If we take a look in ngRepeat documentation we can realise the main goal around this directive: render information iterating over a collection. Reading a little more we can realise that we have other patterns:</p>\n<ul>\n<li>You shouldn’t use <code class=\"language-text\">$</code> or <code class=\"language-text\">$$</code> prefixes in your collection informations: Angular use this character for handle with public (<code class=\"language-text\">$</code>) and private (<code class=\"language-text\">$$</code>) properties. We have some public properties, such as <code class=\"language-text\">$index</code>, <code class=\"language-text\">$first</code>, <code class=\"language-text\">$last</code> and others;</li>\n</ul>\n<p>The interest thing is around angular creates some private properties. One of them is created when track by rule is not added in your iteration/loop.</p>\n<h3>Why we need to pass a index with a unique value</h3>\n<p>The rule around track by is pretty simple. It’s used to avoid duplication in your repeater.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> angular<span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">'plunker'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">controller</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MainCtrl'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>_id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Josh'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>_id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Joseph'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>_id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Kevin'</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ng-repeat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>item in items<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  {{ item.name }}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n...</code></pre></div>\n<p>So in this code example we are not tracking our collection and the angular creates a unique key to avoid <a href=\"https://docs.angularjs.org/error/ngRepeat/dupes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Duplicate Key in Repeater error</a> in our code. This generated unique key is $$hashKey.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/0*jI0RX2-_6kd0CpPw.png\"></p>\n<p>Simple and fast, but now we have a problem. If you change your collection information for any reason (a polling, for example) the way of the data is updated is totally different. If you are not using track by, your angular App creates the $$hashKey property for you and when you update the information you are <strong>removing and creating a new element instead update the data</strong>.</p>\n<blockquote>\n<p>But wait! This is a big performance issue in the framework!</p>\n</blockquote>\n<p>No, it’s not. This is the common “Read the documentation” error. You can <a href=\"https://docs.angularjs.org/api/ng/directive/ngRepeat\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">find all the details in ngRepeat documentation</a>.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/0*gAotBwejnl99ez1f.png\"></p>\n<p>So, the correct implementation is use the same code in your javascript and update your html to track your unique key.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ng-repeat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>item in items track by item._id<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  {{ item.name }}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>PS: If you like to see this code running, please access the <a href=\"https://embed.plnkr.co/vIZP3U\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">plunker with this example using Angular1</a>.</p>\n<h3>Track by in Angular apps</h3>\n<p>In Angular2 apps you should use trackBy too. In the new syntax ngRepeat was replaced to ngFor, but the approach still simple.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token operator\">:</span> <span class=\"token string\">'demo-app'</span><span class=\"token punctuation\">,</span>\n  templateUrl<span class=\"token operator\">:</span> <span class=\"token string\">'app/app.component.html'</span><span class=\"token punctuation\">,</span>\n  pipes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token function\">trackByItemId</span><span class=\"token punctuation\">(</span> index<span class=\"token punctuation\">,</span> item <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TrackBy\"</span><span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">,</span> <span class=\"token string\">\"data using\"</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">,</span> <span class=\"token string\">\"unique key.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>let item of items; trackBy:trackByItemId<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  {{ item.name }}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>PS: If you like to see this code running, please access the <a href=\"http://embed.plnkr.co/oi0OIzoJA9o6ppiMEjQM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">plunker with this example using Angular2</a>.</p>\n<hr/>\n<h3>Conclusion</h3>\n<p>As you can see the benefits around start an application with simple best practices is really powerful. In some specific cases this change can decrease substantially the resource consumption.</p>\n<p>Thank you and see you soon!</p>\n<p>Links:</p>\n<p>Angular <code class=\"language-text\">ngRepeat</code> documentation: <a href=\"https://docs.angularjs.org/api/ng/directive/ngRepeat%5D%5Bng-repeat-docs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.angularjs.org/api/ng/directive/ngRepeat</a></p>\n<ul>\n<li><code class=\"language-text\">Duplicate Key in Repeater</code> error: <a href=\"https://docs.angularjs.org/error/ngRepeat/dupes%5D%5Bng-repeat-dupes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.angularjs.org/error/ngRepeat/dupes</a></li>\n<li>Angular2 — If you are using Angular2, use <code class=\"language-text\">ngForTrackBy</code> in ngFor…PLEASE!: <a href=\"http://embed.plnkr.co/oi0OIzoJA9o6ppiMEjQM/%5D%5Bplunker-angular-2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://embed.plnkr.co/oi0OIzoJA9o6ppiMEjQM/</a></li>\n<li>Angular1 — Use <code class=\"language-text\">track by</code> in ngRepeat…PLEASE!: <a href=\"https://embed.plnkr.co/vIZP3U/%5D%5Bplunker-angular-1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://embed.plnkr.co/vIZP3U/</a></li>\n</ul>","frontmatter":{"date":"August 15, 2016","path":"/posts/why-track-loop-is-important-in-your-angular-apps","title":"Why track loop is important in your angular apps"},"timeToRead":4}},"pageContext":{}},"staticQueryHashes":["63159454"]}