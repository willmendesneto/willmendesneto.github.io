{"componentChunkName":"component---src-templates-post-js","path":"/posts/publishing-angular-module-with-np-package/","result":{"data":{"markdownRemark":{"html":"<p>This is one of the posts about the improvements I've done on <a href=\"https://github.com/willmendesneto/ngx-feature-toggle/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ngx-feature-toggle module</a> and in today the topic is: how to publish a new version of my angular module or angular application.</p>\n<p>Until few months ago, we had several ways to publish an Angular package, independent or module or application. Currently, we can use <code class=\"language-text\">@angular/cli</code> directly to create, run tests, validations, builds and more via CLI commands, which's really useful.</p>\n<p><a href=\"https://blog.angular.io/version-6-of-angular-now-available-cc56b0efa7a4\" title=\"https://blog.angular.io/version-6-of-angular-now-available-cc56b0efa7a4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>Version 6 of Angular Now Available</strong>\n_The 6.0.0 release of Angular is here! This is a major release focused less on the underlying framework, and more on theâ€¦_blog.angular.io</a><a href=\"https://blog.angular.io/version-6-of-angular-now-available-cc56b0efa7a4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"></a></p>\n<blockquote>\n<p>You can read more about it on \"<a href=\"https://github.com/angular/angular-cli/blob/master/docs/documentation/stories/create-library.md#publishing-your-library\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Publishing your library</a>\" section on AngularÂ docs</p>\n</blockquote>\n<p>With that, we can use the same features having the same support to build great libraries as well. You just need to run these commands and all your support is up-to-date ðŸŽ‰. But a good package should follow some good software principles.</p>\n<p>Publish versions needs to be based on <a href=\"https://semver.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Semantic versioning</a>. This standard was created to make sure that upgrade your project using that component should be smooth as much as possible.</p>\n<p>We need to <a href=\"https://keepachangelog.com/en/1.0.0/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">keep a changelog</a> (a ) file with all the changes that happened in the project since the beginning. Usually, in opensource (and non-opensource) projects keep the changes/features/fixes/etc. in a file called<code class=\"language-text\">CHANGELOG.md</code></p>\n<p>Needs to have a well-defined process to build, bundle and publish. But as you can see in different Angular Projects, there are lots of different ways to publish an Angular module and based in a way to cover different bundle types to be published, such as <strong>ESM2015</strong>, <strong>FESM2015</strong>, <strong>FESM5</strong>, <strong>ESM5</strong>, <strong>UMD</strong> and more that NG-Packagr was built.</p>\n<p>Another good decision the Angular CLI team applied was to integrate the publish Angular libraries with Angular-CLI using <a href=\"https://www.npmjs.com/package/ng-packagr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ng-packagr</a>, a package that transpile your libraries to Angular Package Format.</p>\n<p>Some projects are using shell scriptsâ€¦</p>\n<p><div id=\"gist91342511\" class=\"gist\">\n    <div class=\"gist-file\" translate=\"no\" data-color-mode=\"light\" data-light-theme=\"light\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container\">\n  <div id=\"file-ng-publish-sh\" class=\"file my-2\">\n    \n    <div itemprop=\"text\"\n      class=\"Box-body p-0 blob-wrapper data type-shell  \"\n      style=\"overflow: auto\" tabindex=\"0\" role=\"region\"\n      aria-label=\"ng-publish.sh content, created by willmendesneto on 01:17PM on August 15, 2018.\"\n    >\n\n        \n<div class=\"js-check-bidi js-blob-code-container blob-code-content\">\n\n  <template class=\"js-file-alert-template\">\n  <div data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\">\n  <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\">\n    <path d=\"M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z\"></path>\n</svg>\n    <span>\n      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.\n      <a class=\"Link--inTextBlock\" href=\"https://github.co/hiddenchars\" target=\"_blank\">Learn more about bidirectional Unicode characters</a>\n    </span>\n\n\n  <div data-view-component=\"true\" class=\"flash-action\">        <a href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\">    Show hidden characters\n</a>\n</div>\n</div></template>\n<template class=\"js-line-alert-template\">\n  <span aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"line-alert tooltipped tooltipped-e\">\n    <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\">\n    <path d=\"M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z\"></path>\n</svg>\n</span></template>\n\n  <table data-hpc class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip data-tagsearch-path=\"ng-publish.sh\">\n        <tr>\n          <td id=\"file-ng-publish-sh-L1\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"1\"></td>\n          <td id=\"file-ng-publish-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\"># Usage: </td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L2\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"2\"></td>\n          <td id=\"file-ng-publish-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\"># PKG_VERSION=&lt;patch|minor|major&gt; ./publish.sh </td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L3\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"3\"></td>\n          <td id=\"file-ng-publish-sh-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L4\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"4\"></td>\n          <td id=\"file-ng-publish-sh-LC4\" class=\"blob-code blob-code-inner js-file-line\">npm run test &amp;&amp; \\</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L5\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"5\"></td>\n          <td id=\"file-ng-publish-sh-LC5\" class=\"blob-code blob-code-inner js-file-line\">npm run build &amp;&amp; \\</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L6\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"6\"></td>\n          <td id=\"file-ng-publish-sh-LC6\" class=\"blob-code blob-code-inner js-file-line\">npm run bundlesize &amp;&amp; \\</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L7\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"7\"></td>\n          <td id=\"file-ng-publish-sh-LC7\" class=\"blob-code blob-code-inner js-file-line\">node ./build.js &amp;&amp; \\</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L8\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"8\"></td>\n          <td id=\"file-ng-publish-sh-LC8\" class=\"blob-code blob-code-inner js-file-line\">npm publish dist &amp;&amp; \\</td>\n        </tr>\n        <tr>\n          <td id=\"file-ng-publish-sh-L9\" class=\"blob-num js-line-number js-blob-rnum\" data-line-number=\"9\"></td>\n          <td id=\"file-ng-publish-sh-LC9\" class=\"blob-code blob-code-inner js-file-line\">npm version $PKG_VERSION -m &quot;v%s&quot;</td>\n        </tr>\n  </table>\n</div>\n\n\n    </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/willmendesneto/2fe057f934507247760c751be95cda86/raw/e892f1e0f198403600f313c0155492a0995e059c/ng-publish.sh\" style=\"float:right\" class=\"Link--inTextBlock\">view raw</a>\n        <a href=\"https://gist.github.com/willmendesneto/2fe057f934507247760c751be95cda86#file-ng-publish-sh\" class=\"Link--inTextBlock\">\n          ng-publish.sh\n        </a>\n        hosted with &#10084; by <a class=\"Link--inTextBlock\" href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>â€¦or even build systems using Gulp, as used on <a href=\"https://github.com/angular/material2/blob/master/package.json#L15-L25\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Angular Material</a>.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*8bRO8CtMTJv5ONcKN3cF_Q.png\" alt=\"\"></p>\n<p>However, the<code class=\"language-text\">npm publish</code> command by default doesn't trigger any tests and validations. So what you we do in that case?</p>\n<p>To cover this scenario and avoid different approaches to publish a package, having a simple way to ship the new versions with all the steps described here in this post and more, I'm glad to share I added support for folder contents, as existent in <code class=\"language-text\">np publish</code> command.</p>\n<p>How to use it:</p>\n<ul>\n<li>Follow the npm events that <a href=\"https://www.npmjs.com/package/np\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>np</strong></a> triggers: <code class=\"language-text\">test</code>, <code class=\"language-text\">version</code> and <code class=\"language-text\">publish</code>;</li>\n<li>Make sure that the bundle folder with the <code class=\"language-text\">package.json</code> generated internally by NG-Packagr has the <code class=\"language-text\">package.json</code> in the root folder;</li>\n<li>Be happy, you donâ€™t need more shell-scripts or manual steps to publish you code!</li>\n</ul>\n<blockquote>\n<p>You can find more about it <a href=\"https://twitter.com/willmendesneto/status/1000705491385790464\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">in this tweet</a></p>\n</blockquote>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">NP package `v3.0.0` now has support to specify the subdirectory to publish, as we have on `npm publish` command. Stop create shell-scripts to publish your NPM packages, just run `np &lt;patch|minor|major&gt; --contents=&lt;your-folder&gt;`<a href=\"https://t.co/mENfCABotE\">https://t.co/mENfCABotE</a> <a href=\"https://twitter.com/hashtag/gde?src=hash&amp;ref_src=twsrc%5Etfw\">#gde</a> <a href=\"https://twitter.com/hashtag/js?src=hash&amp;ref_src=twsrc%5Etfw\">#js</a> <a href=\"https://twitter.com/hashtag/opensource?src=hash&amp;ref_src=twsrc%5Etfw\">#opensource</a> <a href=\"https://twitter.com/hashtag/node?src=hash&amp;ref_src=twsrc%5Etfw\">#node</a> <a href=\"https://t.co/7CyMSxUKCf\">pic.twitter.com/7CyMSxUKCf</a></p>&mdash; Will Mendes (@willmendesneto) <a href=\"https://twitter.com/willmendesneto/status/1000705491385790464?ref_src=twsrc%5Etfw\">May 27, 2018</a></blockquote>\n<hr/>\n<p>So that's all for now. Follow these steps, run <code class=\"language-text\">np &lt;patch|minor|major> --no-yarn --contents=./dist</code> for an Angular application, or <code class=\"language-text\">np &lt;patch|minor|major> â€”-no-yarn --contents=./dist/&lt;your-angular-module></code> in case you're publishing an Angular module and you're good to go without any problem at all! ðŸŽ‰ðŸŽ‰ðŸŽ‰</p>\n<p>If you want to check an example, please take a look at the setup of <code class=\"language-text\">[ngx-feature-toggle](https://www.npmjs.com/package/ngx-feature-toggle)</code> and <code class=\"language-text\">[ngx-skeleton-loader](https://github.com/willmendesneto/ngx-skeleton-loader)</code> packages.</p>\n<p>â€¦ and what if I told you can use <code class=\"language-text\">@angular/cli</code>` and add all your components there, using it as a mono-repository? But this is a topic for another postÂ ;)</p>\n<p>Cya ðŸ‘‹</p>","frontmatter":{"date":"August 15, 2018","path":"/posts/publishing-angular-module-with-np-package","title":"Publishing Angular Module with NP package","tags":["angular","tooling","module"],"status":"active"},"timeToRead":3}},"pageContext":{"postPath":"/posts/publishing-angular-module-with-np-package"}},"staticQueryHashes":["1559850390","63159454"],"slicesMap":{}}