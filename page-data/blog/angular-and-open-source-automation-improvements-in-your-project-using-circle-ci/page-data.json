{"componentChunkName":"component---src-templates-post-js","path":"/blog/angular-and-open-source-automation-improvements-in-your-project-using-circle-ci","result":{"data":{"markdownRemark":{"html":"<p><img src=\"https://cdn-images-1.medium.com/max/2560/1*A_bbexwTEGYGECTCNsfj_w.png\">\nundefined</p>\n<p>Working in some improvements for <a href=\"https://github.com/willmendesneto/ngx-feature-toggle/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong><em>ngx-feature-toggle</em></strong> component</a>, I noticed that all the automated steps were taking 3 minutes to run using a Circle CI v1 configuration. Since all of them were happening in sequence, that was an opportunity to improve that.</p>\n<p>When we are talking about automation workflow in a project, we need to provide a great experience for the developers. Automate tasks/validations and give them a fast feedback should be always in your plan as a top priority. These are points that make people contribute to your open source project with more confidence.</p>\n<p>For that, moving to use <em>Circle CI v2</em> configuration was a decision to make and these are some of the points that helped in this decision:</p>\n<h3>Clear configuration</h3>\n<p>Configure a project using Circle CI v2, which is not something new, is really transparent. It's interesting that you can find some projects which are not having benefits of all power of the new feature that came from v2 configuration.</p>\n<p>The configuration format using a <code class=\"language-text\">.yaml</code> file is really transparent and steps such as save and restore cache are related to the configuration, not coupled with the platform itself.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1200/1*OuY8Uc0CjYTh-nCvOqxLTA.png\"></p>\n<p>In this example the cache has been restored as a pre-step, the command <code class=\"language-text\">npm install</code> is used to install all the dependencies in case of there’s nothing in the cache and save the content of <code class=\"language-text\">node_modules</code> folder.</p>\n<h3>Reusing configuration</h3>\n<p>Reuse configuration is something straightforward as well. As an example, in the code below you can see the default docker configuration on left and how to add it in your step using <code class=\"language-text\">&lt;&lt;: *docker_defaults</code> syntax.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*zuEXbJ_8V0aPO73gyKaV-g.png\">\nundefined<img src=\"https://cdn-images-1.medium.com/max/600/1*EFfAqzxwraoKR8_YuxF2Yg.png\"></p>\n<p>Using this approach you can reuse your configuration across tasks.</p>\n<h3>Parallelising tasks with workflows</h3>\n<p>Configure tests in parallel or in sequence is quite simple using Circle CI workflows. As example, let's take a look in this configuration.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*eFVRIDJCZRUPccy0wLY1Sw.png\"></p>\n<p>In the code above, we are describing every step of our tasks. The field <code class=\"language-text\">required</code> is used when you need a explicit dependency, sharing that for your task start, it requires a pre step to be finished. So your tasks will run:</p>\n<ol>\n<li>build task will <strong>install</strong> all your <strong>dependencies</strong></li>\n<li>After installed, you can run <strong>unit tests</strong>, <strong>e2e tests</strong> and <strong>bundle size</strong> tasks in <em>parallel</em>, which will give you a fast feedback.</li>\n</ol>\n<p>The new workflow uses some <a href=\"https://www.thoughtworks.com/insights/blog/architecting-continuous-delivery\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">build pipeline concepts</a> to make it faster, such as install all dependencies as first step and parallelism between tasks. That provides us a flexibility since a specific step can be replayed instead of all the tasks or in case of add more tasks in parallel, such as integration tests or performance tests as an example.</p>\n<p>In a real world, it means that if your e2e tests are failing you can replay only the test, avoiding time consuming waiting for install dependencies or run other tasks that you already know are passing.</p>\n<p>And this is the final configuration file with all the steps and validations.</p>\n<p>undefined\nundefined</p>\n<h3>Before and after</h3>\n<p>About numbers and impact, before the project was taking an <strong>average of ~3 minutes</strong>, which is not bad, if you think that are lot of tasks happening in sequence.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*37P1MZGjBuhLlRYCkI4bjA.png\"></p>\n<p>Using the new configuration we are running all the validations with a feedback in less than <strong>1 minute.</strong></p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*etGZK-cMda1pqoDqNoZ7qg.png\">\nundefined<img src=\"https://cdn-images-1.medium.com/max/600/1*Wfi4k8kLjQU6CDx6VRyRYQ.png\"></p>\n<hr/>\n<h3>Conclusion</h3>\n<p>For sure there are lots of tools to use with some pros and cons. In that case, Circle CI solved some of the automation problems, using a clean and expressive configuration. The outcome was a result of focusing in make the development environment for this project transparent and faster.</p>\n<p>What about you? It's time to share what are you doing to improve your automated tasks in your Angular projects. Next post will share some tips and tricks for share your Angular component using <code class=\"language-text\">[**ng-packagr**](https://github.com/dherges/ng-packagr/)</code>.</p>\n<p>I hope you enjoyed this reading. Thank you so much for read until the end and see you soon!</p>","frontmatter":{"date":"April 09, 2018","path":"/blog/angular-and-open-source-automation-improvements-in-your-project-using-circle-ci","title":"Angular and open source: automation improvements in your project using Circle CI"},"timeToRead":3}},"pageContext":{}},"staticQueryHashes":["63159454"]}