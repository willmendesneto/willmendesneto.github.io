<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.8a3be474ae26740c6f65.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{font-family:Poppins,sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-size:30px;font-weight:500;padding:20px 0 0;line-height:1.8em;position:relative;color:#333;width:100%;height:100%}body{box-sizing:border-box;background:#fff;margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;color:#333;-webkit-text-decoration-skip:objects;font-weight:700}a:active,a:hover{outline-width:0;color:#099;opacity:.8}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:30px}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl{margin:0 0 1.45rem}dd,dl,p{padding:0}p{margin-left:0;margin-right:0;margin-top:0}figure{padding:0}figure,pre{margin:0 0 1.45rem}pre{font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:20px 0 10px;margin:0 1.45rem 1.45rem;color:#757575}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}h1,h2,h3,h4,h5,h6{color:#333}h1{font-weight:500}h2,h3,h4,h5,h6{background:transparent;margin-top:40px;font-weight:700;display:inline-block}.gatsby-highlight{border-radius:20px;margin:10px 0 20px}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 3.0.4"/><style data-styled="" data-styled-version="5.2.1">.hKUvcS{max-width:1280px;margin:0 auto;padding-top:0;}/*!sc*/
.hKUvcS h1{font-size:34px;}/*!sc*/
@media (min-width:1024px){.hKUvcS h1{font-size:50px;}}/*!sc*/
@media (min-width:1024px){.hKUvcS{padding-top:50px;}}/*!sc*/
data-styled.g1[id="Section-zthcy2-0"]{content:"hKUvcS,"}/*!sc*/
.RfRpu{display:inline-block;text-align:left;width:40%;}/*!sc*/
data-styled.g3[id="Header__Logo-sc-160kmj-1"]{content:"RfRpu,"}/*!sc*/
.bHSrwR{display:inline-block;height:40px;width:20%;}/*!sc*/
@media (min-width:768px){.bHSrwR{display:none;}}/*!sc*/
.bHSrwR img{border-radius:50%;margin-bottom:0;}/*!sc*/
data-styled.g4[id="Header__LogoMobile-sc-160kmj-2"]{content:"bHSrwR,"}/*!sc*/
.kzsPVe{display:none;}/*!sc*/
@media (min-width:768px){.kzsPVe{display:inline-block;}}/*!sc*/
data-styled.g5[id="Header__LogoDesktop-sc-160kmj-3"]{content:"kzsPVe,"}/*!sc*/
.Ocybt{background:#000;color:#fff;margin:0 auto;padding:10px 15px;position:fixed;text-transform:uppercase;top:0;width:100%;z-index:10;box-sizing:border-box;pointer-events:auto;}/*!sc*/
@media (min-width:768px){.Ocybt{line-height:auto;padding:15px;right:0;padding-top:2vw;padding-bottom:2vw;padding-left:4vw;padding-right:4vw;}}/*!sc*/
.Ocybt a{font-weight:900;color:#fff;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.Ocybt a:hover{color:#fff;opacity:1;-webkit-text-decoration:underline;text-decoration:underline;text-underline-offset:10px;}/*!sc*/
data-styled.g6[id="Header__Nav-sc-160kmj-4"]{content:"Ocybt,"}/*!sc*/
.PjytW{position:relative;overflow-x:auto;padding-top:0;font-size:21px;}/*!sc*/
@media (min-width:1024px){.PjytW{padding:0 20px;max-width:1280px;}}/*!sc*/
data-styled.g7[id="Header__Wrapper-sc-160kmj-5"]{content:"PjytW,"}/*!sc*/
.iLSqRZ{display:inline-block;position:absolute;right:0;}/*!sc*/
@media (min-width:768px){.iLSqRZ{line-height:inherit;}}/*!sc*/
.iLSqRZ a{padding:0;font-size:15px;margin-right:10px;}/*!sc*/
.iLSqRZ a:last-child:after{margin-right:0;}/*!sc*/
@media (min-width:768px){.iLSqRZ a{font-size:21px;margin-right:25px;}}/*!sc*/
data-styled.g8[id="Header__Links-sc-160kmj-6"]{content:"iLSqRZ,"}/*!sc*/
.llqpgS{color:#000;font-size:16px;padding:15px 0;text-align:center;}/*!sc*/
data-styled.g9[id="Footer__Text-sc-14qtz8p-0"]{content:"llqpgS,"}/*!sc*/
.evCYdc{width:100%;min-height:200px;border-top:2px solid #f0f0f2;margin:75px 0 0 0;font-size:16px;text-transform:uppercase;text-align:center;box-sizing:border-box;background:#f0f0f2;}/*!sc*/
.evCYdc ul{display:block;margin:0;margin-bottom:70px;}/*!sc*/
@media (min-width:768px){.evCYdc ul{display:inline-block;vertical-align:middle;}}/*!sc*/
.evCYdc li{display:block;padding:10px;}/*!sc*/
@media (min-width:768px){.evCYdc li{display:inline-block;margin-right:25px;}}/*!sc*/
.evCYdc li a:hover{opacity:0.8;}/*!sc*/
data-styled.g10[id="Footer__PageFooter-sc-14qtz8p-1"]{content:"evCYdc,"}/*!sc*/
.cIXHvf{padding:15px 7px 15px 0;margin:0 auto;width:100%;overflow:hidden;max-width:1280px;font-size:20px;line-height:1.5em;padding:30px 0 0;position:relative;vertical-align:top;}/*!sc*/
@media (min-width:768px){.cIXHvf{font-size:22px;}}/*!sc*/
.cIXHvf pre{border-radius:0;font-size:0.8em;}/*!sc*/
data-styled.g11[id="Layout__Wrapper-xnlv4k-0"]{content:"cIXHvf,"}/*!sc*/
.bBuSAy{display:inline-block;padding:15px;vertical-align:top;width:100%;}/*!sc*/
data-styled.g12[id="Layout__Main-xnlv4k-1"]{content:"bBuSAy,"}/*!sc*/
.fNwryo{font-style:normal;font-weight:900;line-height:1em;margin:50px 0 20px 0;font-size:30px;-webkit-letter-spacing:-2px;-moz-letter-spacing:-2px;-ms-letter-spacing:-2px;letter-spacing:-2px;}/*!sc*/
@media (min-width:768px){.fNwryo{font-size:50px;line-height:1em;margin:70px 0 20px 0;}}/*!sc*/
data-styled.g13[id="Title-sc-1g46602-0"]{content:"fNwryo,"}/*!sc*/
.kSQOnO img{vertical-align:middle;aspect-ratio:auto 245 / 192;}/*!sc*/
.kSQOnO p img{text-align:center;display:block;margin:20px auto;}/*!sc*/
.kSQOnO p .language-text{margin-right:5px;}/*!sc*/
.kSQOnO hr{border:none;background:transparent;color:#111;-webkit-letter-spacing:1em;-moz-letter-spacing:1em;-ms-letter-spacing:1em;letter-spacing:1em;text-align:center;margin-top:10px;margin-bottom:50px;}/*!sc*/
@media (min-width:768px){.kSQOnO hr{margin-bottom:70px;}}/*!sc*/
.kSQOnO hr:before{content:'...';}/*!sc*/
data-styled.g24[id="PostContent__PostWrapper-sc-1jf6w5a-0"]{content:"kSQOnO,"}/*!sc*/
.dVZbmD{color:#4e4c4c;display:block;font-style:italic;margin-bottom:20px;-webkit-letter-spacing:normal;-moz-letter-spacing:normal;-ms-letter-spacing:normal;letter-spacing:normal;line-height:1em;margin-top:10px;text-align:left;text-transform:capitalize;font-size:20px;}/*!sc*/
data-styled.g25[id="PostDate-okmp83-0"]{content:"dVZbmD,"}/*!sc*/
</style><title data-react-helmet="true">Unit test in Johnny-Five nodebot apps | Wilson Mendes</title><meta data-react-helmet="true" name="description" content="Senior Frontend-Engineer, Senior Software-Developer, Google Developer Expert Wen Technologies, Microsoft MVP Developer Technologies"/><meta data-react-helmet="true" property="og:title" content="Unit test in Johnny-Five nodebot apps"/><meta data-react-helmet="true" property="og:description" content="Senior Frontend-Engineer, Senior Software-Developer, Google Developer Expert Wen Technologies, Microsoft MVP Developer Technologies"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:title" content="Unit test in Johnny-Five nodebot apps"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:description" content="Senior Frontend-Engineer, Senior Software-Developer, Google Developer Expert Wen Technologies, Microsoft MVP Developer Technologies"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><link rel="icon" href="/favicon-32x32.png?v=b897f62d006f8ad8d87b6fc5786692ba" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=b897f62d006f8ad8d87b6fc5786692ba"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z1xlFQ.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1xlFQ.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLBT5Z1xlFQ.woff2"/><style>@font-face{font-family:Poppins;font-style:normal;font-weight:500;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z1xlFQ.woff2) format("woff2");font-display:swap}@font-face{font-family:Poppins;font-style:normal;font-weight:700;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1xlFQ.woff2) format("woff2");font-display:swap}@font-face{font-family:Poppins;font-style:normal;font-weight:900;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLBT5Z1xlFQ.woff2) format("woff2");font-display:swap}@font-face{font-family:Poppins;font-style:normal;font-weight:500;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z1xlEw.woff) format("woff");font-display:swap}@font-face{font-family:Poppins;font-style:normal;font-weight:700;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1xlEw.woff) format("woff");font-display:swap}@font-face{font-family:Poppins;font-style:normal;font-weight:900;src:url(/static/webfonts/s/poppins/v15/pxiByp8kv8JHgFVrLBT5Z1xlEw.woff) format("woff");font-display:swap}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="alternate" type="application/rss+xml" title="Will Mendes Blog RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-23e80c2ddd056a24e52f.js"/><link as="script" rel="preload" href="/framework-5a0f89685a3614932ea6.js"/><link as="script" rel="preload" href="/app-a4dce349d972e2f96f4f.js"/><link as="script" rel="preload" href="/c38806a22704b1411d609490b31463a94158f97c-251d4b46df1e4f161a6b.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-20d5c25fe44c354044f8.js"/><link as="fetch" rel="preload" href="/page-data/blog/unit-test-in-johnny-five-nodebot-apps/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="Header__PageHeader-sc-160kmj-0 coHUrI"><nav class="Header__Nav-sc-160kmj-4 Ocybt"><section class="Section-zthcy2-0 Header__Wrapper-sc-160kmj-5 hKUvcS PjytW"><span class="Header__Logo-sc-160kmj-1 Header__LogoMobile-sc-160kmj-2 RfRpu bHSrwR"><a href="/">WM</a></span><span class="Header__Logo-sc-160kmj-1 Header__LogoDesktop-sc-160kmj-3 RfRpu kzsPVe"><a href="/">Wilson Mendes</a></span><div class="Header__Links-sc-160kmj-6 iLSqRZ"><a href="/posts/">posts</a><a href="/talks/">talks</a></div></section></nav></header><div class="Layout__Wrapper-xnlv4k-0 cIXHvf"><main class="Layout__Main-xnlv4k-1 bBuSAy"><section class="Section-zthcy2-0 hKUvcS"><h1 class="Title-sc-1g46602-0 fNwryo">Unit test in Johnny-Five nodebot apps</h1><time class="PostDate-okmp83-0 dVZbmD">June 27, 2016<!-- --> - <!-- -->4 min read</time><article class="PostContent__PostWrapper-sc-1jf6w5a-0 kSQOnO"><div><p>This time something simple, but without good information about it is how to add unit tests in Nodebots apps.</p>
<blockquote>
<p>Unit test? But this is not a new thing</p>
</blockquote>
<p>Yes, you’re right, but you can find few contents about this topic in Arduino, robots and open hardware apps.</p>
<p>But relax … this is not a big deal ;)</p>
<h3>Unit tests</h3>
<p>Unit test is only one way to test your software. Based in the <a href="http://martinfowler.com/bliki/TestPyramid.html" target="_blank" rel="nofollow noopener noreferrer">test pyramid</a> this is the way that you can organize the tests your application.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/0*3njsTEPjz8qom_kl.png">
undefined</p>
<blockquote>
<p><em>In this post we will talk only of unit tests, if you like to know more about all the layers, please read</em> <a href="http://martinfowler.com/bliki/TestPyramid.html" target="_blank" rel="nofollow noopener noreferrer"><em>“TestPyramid” post of Martin Fowler</em></a></p>
</blockquote>
<p>The idea of the unit test is validate your code, make sure that your code is doing what it suppose to do and give you feedback about the errors fast (before your deploy pipeline steps) when the assertion fails.</p>
<p>The validation of this concept was in the <a href="https://github.com/willmendesneto/build-checker" target="_blank" rel="nofollow noopener noreferrer">Build Checker repository</a> and was really easy.</p>
<blockquote>
<p><em>If you like to know more about the project, please read</em> <a href="http://willmendesneto.github.io/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino" target="_blank" rel="nofollow noopener noreferrer"><em>“Checking your build in SNAP-CI via nodebots using NodeJS and Arduino”</em></a></p>
</blockquote>
<h3>What about nodebots?</h3>
<p>One aspect that nobody explain very well is about the tests in nodebots. The main goal in this case is create the electric mocks and stubs and simulate the communication between components.</p>
<p>One useful package is <a href="https://github.com/rwaldron/mock-firmata" target="_blank" rel="nofollow noopener noreferrer">mock-firmata</a>, created by Rick Waldron to make the tests in <a href="http://johnny-five.io" target="_blank" rel="nofollow noopener noreferrer">Johnny-Five</a> easier. The integration is really simple, you just need to load and create your board component in the test.</p>
<p>require('should');
var mockFirmata = require('mock-firmata');
var five = require('johnny-five');
var Board = five.Board;
var Accelerometer = five.Accelerometer;</p>
<p>var board = new Board({
io: new mockFirmata.Firmata(),
debug: false,
repl: false
});</p>
<p>After the integration, the unit tests is using mocha test framework (but you can use others, if you like), <a href="http://sinonjs.org/" target="_blank" rel="nofollow noopener noreferrer">sinon js</a> in test spies, stubs and mocks and <a href="https://shouldjs.github.io/" target="_blank" rel="nofollow noopener noreferrer">should js</a> for the assertions.</p>
<p>One simple way to validation is when the build checker should blink the led. Basically you have to create a stub for the request (in this case using <a href="https://github.com/request/request" target="_blank" rel="nofollow noopener noreferrer">request package</a>) for validate the response by expected types (success and error) and spy the led components.</p>
<p>After this is create the scenario for validate this case. Nothing really hard, right? Some things that you need to remember about the test is that your beforeEach method should be a documentation about the steps to reproduce your scenario.</p>
<p>require('should');
const request = require('request');
const sinon = require('sinon');</p>
<p>...
describe('When the CI server send success response', () => {
beforeEach(() => {
successResponseCI = `your awesome response`;</p>
<p>this.clock = sinon.useFakeTimers();
sinon.stub(request, 'get').yields(null, null, successResponseCI);
sinon.spy(buildChecker.ledSuccess, 'on');
sinon.spy(buildChecker.ledError, 'off');</p>
<p>buildChecker.startPolling();
this.clock.tick(CONFIG.INTERVAL);
});</p>
<p>afterEach(() => {
request.get.restore();
this.clock.restore();
});</p>
<p>it('should turn on the success led', () => {
buildChecker.ledSuccess.on.calledOnce.should.be.true;
});</p>
<p>it('should turn off the error led', () => {
buildChecker.ledError.off.calledOnce.should.be.true;
});</p>
<p>});
...</p>
<p>After this you can add more tests and create your pipeline correctly, so you are sure that your code is covered. The final result is :</p>
<p><img src="https://cdn-images-1.medium.com/max/800/0*Guw1r56Nwz6N0E0n.png">
undefined</p>
<p>*** This don’t remove other validations, as validation with software, but it’s another way to validate first the new features, updates, etc.</p>
<blockquote>
<p>If you like to know more about Nodebots, please check my book <a href="https://leanpub.com/nodebots-javascript-and-robotic-in-the-real-world" target="_blank" rel="nofollow noopener noreferrer">“Nodebots — Javascript and robotic in the real world”</a></p>
</blockquote>
<hr/>
<h3>Conclusion</h3>
<p>As you can see the integration with unit tests is really easy and you can make sure that at least these cases are covered in your app. In this repository is integrated code coverage badge, code lint and more.</p>
<p>How about you? How you are using node js and unit tests? Are you testing your node js embedded applications? Share your experience!</p>
<p>Thank you and see you soon!</p>
<p>Links:</p>
<p>- Johnny-Five: <a href="http://johnny-five.io" target="_blank" rel="nofollow noopener noreferrer">http://johnny-five.io</a>
- Test pyramid: <a href="http://martinfowler.com/bliki/TestPyramid.html" target="_blank" rel="nofollow noopener noreferrer">http://martinfowler.com/bliki/TestPyramid.html</a>
- Mock Firmata: <a href="https://github.com/rwaldron/mock-firmata" target="_blank" rel="nofollow noopener noreferrer">https://github.com/rwaldron/mock-firmata</a>
- Build Checker: <a href="https://github.com/willmendesneto/build-checker" target="_blank" rel="nofollow noopener noreferrer">https://github.com/willmendesneto/build-checker</a>
- Sinon JS: <a href="http://sinonjs.org/" target="_blank" rel="nofollow noopener noreferrer">http://sinonjs.org/</a>
- Should JS: <a href="https://shouldjs.github.io/" target="_blank" rel="nofollow noopener noreferrer">https://shouldjs.github.io/</a>
- Mocha JS: <a href="https://mochajs.org/" target="_blank" rel="nofollow noopener noreferrer">https://mochajs.org/</a></p>
<p><em>Originally published at</em> <a href="http://willmendesneto.github.io/2016/06/27/unit-test-in-johnny-five-nodebot-apps" target="_blank" rel="nofollow noopener noreferrer"><em>willmendesneto.github.io</em></a> <em>on June 27, 2016.</em></p></div></article></section></main></div><footer class="Footer__PageFooter-sc-14qtz8p-1 evCYdc"><ul><li><a href="https://twitter.com/willmendesneto" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="https://github.com/willmendesneto" target="_blank" rel="noopener noreferrer">Github</a></li><li><a href="/rss.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="Footer__Text-sc-14qtz8p-0 llqpgS">made by me with<!-- --> <span role="img" aria-label="love">❤️</span> <!-- -->since 2014</p></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-58169656-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/unit-test-in-johnny-five-nodebot-apps";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2645f3231365ba51a296.js"],"app":["/app-a4dce349d972e2f96f4f.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-1bc4087bda7d163b6bc1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d991251d90476ebcd163.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-0131fe49b0c3c81f4a45.js"],"component---src-pages-index-js":["/component---src-pages-index-js-768f221821aa187b9b2d.js"],"component---src-pages-posts-js":["/component---src-pages-posts-js-cc69178b0a79363bc455.js"],"component---src-pages-talks-js":["/component---src-pages-talks-js-f9aa2b44549f3d72d71f.js"],"component---src-pages-workshops-js":["/component---src-pages-workshops-js-a1bb33d608065aa003cf.js"],"component---src-templates-post-js":["/component---src-templates-post-js-20d5c25fe44c354044f8.js"]};/*]]>*/</script><script src="/polyfill-2645f3231365ba51a296.js" nomodule=""></script><script src="/component---src-templates-post-js-20d5c25fe44c354044f8.js" async=""></script><script src="/c38806a22704b1411d609490b31463a94158f97c-251d4b46df1e4f161a6b.js" async=""></script><script src="/app-a4dce349d972e2f96f4f.js" async=""></script><script src="/framework-5a0f89685a3614932ea6.js" async=""></script><script src="/webpack-runtime-23e80c2ddd056a24e52f.js" async=""></script></body></html>